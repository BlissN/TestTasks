Ограничения и допущения:

Task1:
Решение появилось в момент написания проверок и разбора логов. А если что-то проще и быстрее сделать руками - нет смысла писать для этого код.

Task2:
Протоколы и флаги не убирались намеренно

Task3:
Невалидные адреса не учитываются в общей выборке
10.181.233.206 - хоть и используется в качестве идентификатора, но тоже является IP