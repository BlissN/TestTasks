Ограничения и допущения:

Если что-то проще и быстрее сделать руками - нет смысла писать для этого код.

Task3:
Невалидные адреса не учитываются в общей выборке
